{% extends 'layout.html' %}
{% block content %}

    <link rel="stylesheet" href="{{ url_for('static', filename='css/devices.css') }}"> 


    <div class="devices">
        {% include 'header.html' %}
        <div class="bento">
            <div class="divider colored">
                <h1>Devices</h1>
                <table>
                    <thead>
                        <tr>
                            <th>Ip</th>
                            <th>Status</th>
                            <th>Location</th>
                            <th> Actions </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% set ns = namespace(LineNb=0) %}
                        {% for el in sps.findAllByOrganisation(ogs.getIdByName(orga))  %}
                            {% if ns.LineNb < 4 %}
                                {% set ns.LineNb = ns.LineNb + 1 %}
                                <tr>
                                    <td> {{ el['IP_adress'] }} </td>
                                    <td class="{% if el['state'] == 'ONLINE' %}green{% elif el['state'] == 'OFFLINE' %}red{% endif %}">
                                        {{ el['state'] }}
                                    </td>
                                    <td> {{ el['name_place'] }}</td>
                                    <td class="actions-cell">
                                        <div class="buttons-wrapper">
                                            <a href="/delete/{{ el['id'] }}" class="custom-btn btn-red" onclick="return confirm('Confirm deletion?')">Delete</a>
                                            <a href="/update/{{ el['id'] }}" class="custom-btn btn-yellow" onclick="return confirm('Confirm update?')">Update</a>
                                        </div>
                                    </td>
                                </tr>
                            {%endif%}
                        {% endfor %}
                            
                        <!-- Completion of empty lines -->
                        {% for i in range(ns.LineNb, 4) %}
                            <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                        {% endfor %}
                        <tr>
                            <td> Offline : <span class="red"> {{ sps.CountAllByOrganisationAndStatus(ogs.getIdByName(orga), 'OFFLINE') }}</span></td>
                            <td> Playing : <span class="green"> {{ sps.CountAllByOrganisationAndStatus(ogs.getIdByName(orga), 'ONLINE') }}</span></td>
                            <td></td>
                            <td>&nbsp;</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}